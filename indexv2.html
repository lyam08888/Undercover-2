<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
<title>Undercover - R√©volution</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<meta name="theme-color" content="#0D1117">
<link rel="stylesheet" href="assets/css/app.css">
<script src="https://cdn.jsdelivr.net/npm/tsparticles@3.4.0/tsparticles.bundle.min.js"></script>
</head>
<body>
<div id="tsparticles"></div>
<div class="app">
  <header id="game-header">
    <div class="bar">
      <div class="title">Undercover</div>
      <div class="spacer"></div>
      <button id="btnShowMyCard" class="icon-btn" title="Voir ma carte" style="display: none;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></button>
      <button id="btnNewWord" class="icon-btn" title="Nouveau mot" style="display: none;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg></button>
      <button id="btnReset" class="icon-btn" title="Nouvelle partie"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg></button>
      <button id="btnHelp" class="icon-btn" title="R√®gles"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg></button>
    </div>
  </header>

  <main>
    <!-- HOME -->
    <section id="screen-home" class="screen active">
      <button id="home-sound-toggle" class="icon-btn">üîá</button>
      <div class="center" style="display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 3rem 1rem; gap: 2.5rem;">
            <div class="title-container" style="position: relative; display: flex; flex-direction: column; align-items: center;">
              <div class="home-logo-container">
                <svg id="home-logo" class="home-logo" viewBox="0 0 200 80" width="150">
                    <g fill="none" stroke="var(--accent)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M 30 60 Q 100 80 170 60" />
                        <path d="M 50 58 C 50 30, 70 20, 100 20 C 130 20, 150 30, 150 58" />
                        <path d="M 80 30 C 85 25, 115 25, 120 30" />
                    </g>
                </svg>
              </div>
              <h1 class="home-title" style="animation: fadeInUp .5s .6s both;">Undercover</h1>
            </div>
        <div style="animation: fadeInUp .5s .3s both; display: flex; flex-direction: column; gap: .75rem; width: 80%; max-width: 300px;">
                <button id="start-game-btn" class="btn" style="width: 100%; padding: 1rem 2rem;">Commencer √† jouer</button>
            </div>
        <div class="tip-box" style="animation: fadeInUp .5s .5s both; max-width: 380px;">Le but est simple : les Civils doivent d√©masquer les Undercover, et les Undercover doivent survivre !</div>
        </div>
    </section>

    <!-- INTRO -->
    <section id="screen-intro" class="screen">
        <div class="center" style="justify-content: center; text-align: center; padding: 2rem;">
            <div id="intro-text-container" style="min-height: 120px; display: flex; align-items: center; justify-content: center;">
                <h2 id="intro-text" style="font-size: 1.75rem; font-weight: 700; animation: fadeIn .5s forwards;">Votre mission, si vous l'acceptez...</h2>
            </div>
            <div id="intro-buttons" style="margin-top: 3rem; opacity: 0; transition: opacity .5s ease .5s; width: 100%; max-width: 320px;">
                <button id="intro-continue-btn" class="btn">J'ai compris</button>
                <button id="intro-skip-btn" class="btn ghost" style="margin-top: .75rem;">Passer</button>
            </div>
        </div>
    </section>

    <!-- SETUP -->
    <section id="screen-setup" class="screen">
        <!-- Step 1: Mode -->
        <div class="setup-step active" data-step="1">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>Mode de Jeu <button id="btn-random-mode" class="icon-btn" title="Mode al√©atoire" style="font-size: 1.5rem; margin-left: auto;">üé≤</button></h1>
                <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">
                    <select id="game-mode-select" class="input-like" style="width: 100%; padding: .75rem 1rem; font-size: 1rem; color:var(--ink); background:var(--bg); border:1px solid var(--border); border-radius:8px; outline:none; transition: all .2s ease; appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23e6edf3%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.6-3.6%205.4-7.9%205.4-12.9%200-5-1.9-9.4-5.4-12.7z%22/%3E%3C/svg%3E'); background-repeat: no-repeat, repeat; background-position: right .7em top 50%, 0 0; background-size: .65em auto, 100%;"></select>
                    <div id="game-mode-description" class="tip-box" style="text-align: left; min-height: 80px;"></div>
                </div>
            </div>
        </div>
        <!-- Step 2: Mission -->
        <div class="setup-step" data-step="2">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.5 17a2.4 2.4 0 0 1 3 0L8 20l3-3a2.4 2.4 0 0 1 3 0L19.5 20a2.4 2.4 0 0 1 0-3L17 15l3-3a2.4 2.4 0 0 0 0-3L15 4l-3 3a2.4 2.4 0 0 0-3 0L4 4a2.4 2.4 0 0 0 0 3l3 3-2.5 2.5a2.4 2.4 0 0 0 0 3Z"/></svg>Choisissez un th√®me<button id="btn-random-theme" class="icon-btn" title="Th√®me al√©atoire" style="font-size: 1.5rem; margin-left: auto;">üé≤</button></h1>
                <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">
                    <select id="theme-select" class="input-like" style="width: 100%; padding: .75rem 1rem; font-size: 1rem; color:var(--ink); background:var(--bg); border:1px solid var(--border); border-radius:8px; outline:none; transition: all .2s ease; appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23e6edf3%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.6-3.6%205.4-7.9%205.4-12.9%200-5-1.9-9.4-5.4-12.7z%22/%3E%3C/svg%3E'); background-repeat: no-repeat, repeat; background-position: right .7em top 50%, 0 0; background-size: .65em auto, 100%;"></select>
                    <div id="theme-description" class="tip-box" style="text-align: left; min-height: 80px;"></div>
                </div>
            </div>
        </div>
        <!-- Step 3: Communication -->
        <div class="setup-step" data-step="3">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg>Mode de Communication</h1>
                <p class="hint" style="margin-top: 0.5rem; text-align: center;">Comment donnerez-vous vos indices ?</p>
                <div class="setup-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: .75rem; align-content: center; flex: 1; margin-top: 1rem;">
                    <div id="option-comm-oral" class="option-card active">
                        <div class="icon">üó£Ô∏è</div>
                        <div class="label">Oral</div>
                        <div class="value">Indices parl√©s √† voix haute.</div>
                    </div>
                    <div id="option-comm-ecrit" class="option-card">
                        <div class="icon">‚úçÔ∏è</div>
                        <div class="label">√âcrit</div>
                        <div class="value">Indices saisis dans l'app.</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Step 4: Agents -->
        <div class="setup-step" data-step="4">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Param√©trez les agents</h1>
                <div class="row" style="margin-top:1rem"><div class="pill" style="flex:1.5"><span><b>Agents Humains</b> (0‚Äì12)</span><div class="numstep"><button id="minus" class="step-btn">‚àí</button><div id="playerNum" class="counter">4</div><button id="plus" class="step-btn">+</button></div></div><div class="pill" style="flex:1"><span>Bots IA</span><div class="numstep"><button id="minusBot" class="step-btn">‚àí</button><div id="botNum" class="counter">0</div><button id="plusBot" class="step-btn">+</button></div></div></div>
                <p class="hint" style="margin-top: auto; text-align: center; padding-top: 1rem;">Le nombre total d'agents (humains + bots) doit √™tre entre 3 et 12.</p>
            </div>
        </div>
        <!-- Step 5: Options -->
        <div class="setup-step" data-step="5">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>Options G√©n√©rales</h1>
                <div id="game-options-container" style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">
                    <!-- Sound Option will be dynamically inserted here -->
                </div>
                 <div class="tip-box" style="margin-top: 1rem;">
                    Configurez ici les options g√©n√©rales de la partie. Les r√¥les sp√©ciaux seront configur√©s √† l'√©tape suivante.
                </div>
            </div>
        </div>
        <!-- Step 6: Special Roles -->
        <div class="setup-step" data-step="6">
            <div class="card">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 2-3.5 3.5 3.5 3.5 3.5-3.5Z"/><path d="m2 12 3.5 3.5 3.5-3.5-3.5-3.5Z"/><path d="m12 22 3.5-3.5-3.5-3.5-3.5 3.5Z"/><path d="M22 12 18.5 8.5 15 12l3.5 3.5Z"/></svg>R√¥les Sp√©ciaux</h1>
                <div id="special-roles-container" style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">
                    <button id="configure-roles-btn" class="input-like" style="text-align: left; display: flex; justify-content: space-between; align-items: center; width: 100%; padding: .75rem 1rem; font-size: 1rem; color:var(--ink); background:var(--bg); border:1px solid var(--border); border-radius:8px; outline:none; transition: all .2s ease; cursor: pointer;">
                        <span id="configure-roles-label">Aucun r√¥le sp√©cial</span>
                        <span style="color: var(--muted);">Configurer ‚ñº</span>
                    </button>
                    <div id="options-description" class="tip-box" style="text-align: left; min-height: 80px;">
                        Cliquez pour ajouter des r√¥les comme l'Innocent, le Jester, et plus encore pour pimenter vos parties. Chaque r√¥le ajoute de nouvelles conditions de victoire !
                    </div>
                </div>
            </div>
        </div>
        <!-- Step 7: Players -->
        <div class="setup-step" data-step="7">
            <div class="card">
                <h1 style="font-size: 1.25rem;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Agents Humains</h1>
                <div id="playersSetup" class="players" style="flex: 1; overflow-y: auto;"></div>
            </div>
        </div>
    </section>

    <!-- SUMMARY -->
    <section id="screen-summary" class="screen">
        <div class="center" style="justify-content: flex-start; text-align: left; padding: 2rem 1.5rem; gap: 1.25rem; overflow-y: auto;">
            <h1 id="summary-title" style="text-align: center; width: 100%; font-size: 1.75rem;">R√©capitulatif de la Mission</h1>

            <div id="summary-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; width: 100%;">
                <div id="summary-mode" class="summary-card">
                    <h3>Mode de Jeu</h3>
                    <p><span class="icon"></span> <span class="label"></span></p>
                </div>
                <div id="summary-theme" class="summary-card">
                    <h3>Th√®me</h3>
                    <p><span class="icon"></span> <span class="label"></span></p>
                </div>
            </div>

            <div id="summary-roles" class="summary-card" style="width: 100%;">
                <h3>R√¥les Sp√©ciaux Actifs</h3>
                <div class="roles-pills"></div>
            </div>

            <div id="summary-players" class="summary-card" style="width: 100%;">
                <h3>Agents Participants</h3>
                <div class="player-list"></div>
            </div>

            <p id="summary-countdown" class="hint" style="text-align: center; width: 100%; margin-top: auto; padding-top: 1rem;">La mission commence dans 5...</p>
        </div>
    </section>

    <!-- PASS & CARD REVEAL -->
    <section id="screen-pass" class="screen">
        <div class="pass-container">
            <div style="text-align:center;"><h1>Passez √† <b id="currentName"></b></h1><p class="hint">Touchez la carte pour r√©v√©ler votre r√¥le secret. <br>Cachez-la avant de passer au suivant.</p></div>
            <div class="reveal-card-wrapper"><div id="revealCard" class="reveal-card"><div class="card-face card-front"><div class="icon">?</div><div class="text">TOUCHER POUR R√âV√âLER</div></div><div class="card-face card-back"><div id="secretWord" class="word-big"></div></div></div></div>
        </div>
    </section>

    <!-- GAME ROUND -->
    <section id="screen-game" class="screen">
        <div class="game-container">
            <div id="turn-display" class="turn-display"></div>
            <div id="game-content-area" class="game-content-area"></div>
            <div class="tip-box" style="margin: 0 1rem 1rem 1rem;">Observez les r√©actions des autres apr√®s chaque indice. Une h√©sitation peut √™tre r√©v√©latrice.</div>
        </div>
    </section>
    
    <!-- EVENT -->
    <section id="screen-event" class="screen">
        <div class="center">
            <div id="event-icon"></div>
            <h1 id="event-title"></h1>
            <p id="event-description" class="hint"></p>
            <div class="tip-box" style="margin-top: 2rem;">Les √©v√©nements peuvent retourner la situation. Utilisez-les √† votre avantage !</div>
        </div>
    </section>

    <!-- REVEAL / RESULT -->
    <section id="screen-reveal" class="screen">
      <div class="center" style="gap:.8rem;"><div id="revealPhoto" class="avatar reveal-avatar" style="width:120px;height:120px;border-radius:50%;"></div><h1 id="revealTitle" class="reveal-title" style="margin-top: 1rem;"></h1><div class="card reveal-card-info" style="max-width:400px; width: 100%;"><div id="roleBadge" style="font-weight: 600; color: var(--muted); margin-bottom: .5rem;">R√¥le</div><div id="revealedWord" style="font-size: 1.2rem; font-weight: 700;"></div></div>
      <div class="tip-box" style="margin-top: 1.5rem;">Si un Civil est √©limin√©, les Undercover gagnent du terrain. S'il s'agissait d'un Undercover, vous √™tes plus proches de la victoire !</div></div>
    </section>
    
    <!-- LAST WORD -->
    <section id="screen-lastword" class="screen">
        <div class="center" style="gap: 1rem;">
            <h1>Dernier Mot</h1>
            <p class="hint" id="lastword-prompt"></p>
            <div id="lastword-grid" class="player-grid-vote"></div>
            <div class="tip-box">Votre "dernier mot" peut influencer le prochain vote. Choisissez judicieusement !</div>
        </div>
    </section>

    <!-- END -->
    <section id="screen-end" class="screen">
      <div class="center" style="gap:.8rem;"><h1 id="winnerBanner" class="winner-banner" style="font-size: 2.5rem;"></h1><p id="summary" class="hint" style="max-width: 400px; animation: fadeInUp .5s .2s both;"></p>
      <div id="vote-reveal-container" class="card" style="width: 100%; max-width: 400px; display:none; animation: fadeInUp .5s .4s both;">
        <h2>Qui a vot√© contre qui ?</h2>
        <div id="vote-reveal-details"></div>
      </div>
      <div class="tip-box" style="animation: fadeInUp .5s .6s both;">Chaque partie est diff√©rente. Essayez de nouvelles strat√©gies, de nouveaux th√®mes et de nouveaux r√¥les !</div>
      </div>
    </section>
  </main>

  <div id="transition-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--bg); display: none; place-items: center; z-index: 50;">
    <svg id="transition-logo" viewBox="0 0 200 80" width="150" style="width: 120px; height: auto; stroke: var(--accent); stroke-width: 6; stroke-linecap: round; stroke-linejoin: round; fill: none;">
        <g>
            <path d="M 30 60 Q 100 80 170 60"></path>
            <path d="M 50 58 C 50 30, 70 20, 100 20 C 130 20, 150 30, 150 58"></path>
            <path d="M 80 30 C 85 25, 115 25, 120 30"></path>
        </g>
    </svg>
  </div>

  <div id="actionBar" class="action-bar"></div>
</div>

<!-- Modals -->
<dialog id="modal-template">
    <div class="modal"><h2 id="modal-title"></h2><p id="modal-message"></p><div id="modal-input-wrap" style="display:none;"><input type="text" id="modal-input" style="width: 100%;"></div><div id="modal-actions" class="row" style="margin-top:1.5rem"></div></div>
</dialog>

<script type="module" src="assets/js/app.js"></script>
</body>
</html>
